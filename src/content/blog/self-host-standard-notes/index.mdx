---
title: "Self-Hosting Standard Notes"
description: "A detailed walkthrough of how I self-hosted Standard Notes with Docker, Caddy, and Cloudflare"
date: 2025-06-30
tags: ["self-hosting", "docker", "caddy", "proxmox"]
draft: true
---

## Introduction

I've been a happy Standard Notes user for a while, but I wanted to take control of my data by self-hosting it. This way, my encrypted notes stay on my own infrastructure.

I'll walk you through how I set up my own Standard Notes server using my [Proxmox server](/blog/how-i-installed-proxmox-on-my-old-intel-nuc), Caddy as a reverse proxy, pfSense for networking, and Cloudflare for DNS.

## Architecture Overview

Here's my setup:
- **Frontend Web App**: Running on Docker at `notes.domain.com`
- **Backend API Server**: Running on Docker at `notes-api.domain.com`
- **Files Server**: Running on Docker at `notes-sync.domain.com`
- **Reverse Proxy**: Caddy for SSL and routing
- **DNS**: Cloudflare with dynamic DNS through pfSense
- **Domains**:
  - `notes.domain.com` → Frontend web app
  - `notes-api.domain.com` → Backend API
  - `notes-sync.domain.com` → Files server

## Prerequisites

Before you start, make sure you have:
- A Proxmox server (or any server that can run Docker)
- A domain name managed through Cloudflare
- pfSense set up with Cloudflare dynamic DNS
- Some basic knowledge of Docker and Docker Compose

## Setting Up the Backend

The Standard Notes backend runs in Docker containers. I followed the [official Docker guide](https://standardnotes.com/help/self-hosting/docker) with a few tweaks.

### Step 1: Create the Working Directory

SSH into your Proxmox server and create a directory:

```bash
mkdir /opt/standardnotes
cd /opt/standardnotes
```

### Step 2: Download Configuration Files

Download the necessary files:

```bash
# Download the environment template
curl https://raw.githubusercontent.com/standardnotes/server/main/.env.sample > .env

# Download the docker-compose file
curl https://raw.githubusercontent.com/standardnotes/server/main/docker-compose.example.yml > docker-compose.yml

# Download the LocalStack bootstrap script
curl https://raw.githubusercontent.com/standardnotes/server/main/docker/localstack_bootstrap.sh > localstack_bootstrap.sh
chmod +x localstack_bootstrap.sh
```

### Step 3: Configure Environment Variables

Edit the `.env` file:

```bash
nano .env
```

Here are the key changes I made:

```bash
# Generate secure keys (run: openssl rand -hex 32)
AUTH_JWT_SECRET=your_generated_key_here
ENCRYPTION_SERVER_KEY=your_generated_key_here
VALET_TOKEN_SECRET=your_generated_key_here
WEBSOCKETS_API_GATEWAY_KEYS=your_generated_key_here

# Database configuration
DB_PASSWORD=your_secure_db_password

# Important: Set the cookie domain for cross-domain authentication
COOKIE_DOMAIN=notes-api.domain.com

# Disable user registration for security
DISABLE_USER_REGISTRATION=true

# File server configuration
PUBLIC_FILES_SERVER_URL=https://notes-sync.domain.com
```

### Step 4: Update Docker Compose Configuration

Edit the `docker-compose.yml` file to update the database password:

```bash
nano docker-compose.yml
```

Update the MySQL environment variables to match your `.env` file:

```yaml
environment:
  MYSQL_ROOT_PASSWORD: your_secure_db_password
  MYSQL_PASSWORD: your_secure_db_password
```

### Step 5: Deploy the Backend

Start the backend services:

```bash
docker compose pull && docker compose up -d
```

Check the logs to make sure everything started correctly:

```bash
tail -f logs/*.log
```

## Setting Up the Frontend Web App

The frontend is easier to set up. I used the [official web app Docker image](https://standardnotes.com/help/self-hosting/web-app).

### Step 1: Create Web App Directory

```bash
mkdir /opt/standardnotes-web
cd /opt/standardnotes-web
```

### Step 2: Create Docker Compose for Web App

Create a `docker-compose.yml` file:

```yaml
version: '3.8'

services:
  web:
    image: standardnotes/web:latest
    container_name: standardnotes-web
    ports:
      - "3003:80"
    restart: unless-stopped
```

### Step 3: Deploy the Web App

```bash
docker compose up -d
```

## Configuring Caddy Reverse Proxy

I use Caddy for my reverse proxy because it handles SSL automatically. Here's my Caddyfile configuration:

```caddyfile
notes.domain.com {
	reverse_proxy 192.168.xx.xx:3003
}

notes-api.domain.com {
	reverse_proxy 192.168.xx.xx:3000
}

notes-sync.domain.com {
	reverse_proxy 192.168.xx.xx:3125
}
```

This setup routes traffic to the correct containers and handles SSL for all three subdomains.

## Network Configuration

### pfSense Dynamic DNS

I set up pfSense to update my Cloudflare DNS records automatically:

1. **Services** → **Dynamic DNS**
2. **Add** a new entry with:
   - Service Type: Cloudflare
   - Hostname: `*.domain.com` (wildcard)
   - Domain: `domain.com`
   - Username: Your Cloudflare email
   - Password: Your Cloudflare API token

### Firewall Rules

Make sure your pfSense firewall allows:
- HTTP (80) and HTTPS (443) traffic to your Caddy server
- Internal traffic from Caddy to your Standard Notes server (ports 3000, 3003, 3125)

## Important Configuration Notes

### Security

1. **Disable User Registration**: I set `DISABLE_USER_REGISTRATION=true` so only I can create accounts.

2. **Cookie Domain**: Setting `COOKIE_DOMAIN=notes-api.domain.com` is important for authentication to work correctly.

3. **SSL Everywhere**: Caddy's automatic HTTPS encrypts all traffic.

### Creating Your First User

Since registration is disabled, you'll need to create your account manually. You can do this by temporarily enabling registration, creating your account, and then disabling it again.

## Testing Your Setup

1. **Visit your web app**: Go to `https://notes.domain.com`
2. **Configure sync server**: In the account menu, go to "Advanced options" and set your custom sync server to `https://notes-api.domain.com`
3. **Create or log into your account**
4. **Test file uploads** to make sure the files server is working.

## Maintenance and Updates

### Updating the Backend

```bash
cd /opt/standardnotes
docker compose down
docker compose pull
docker compose up -d
```

### Updating the Web App

```bash
cd /opt/standardnotes-web
docker compose down
docker compose pull
docker compose up -d
```

### Backup Strategy

Remember to back up your:
- Database
- Uploaded files
- Configuration files

## Conclusion

Self-hosting Standard Notes gives you full control over your notes. With Docker, Caddy, and a good network setup, you get a secure and private notes platform.

This setup gives you:
- Complete data ownership
- Automatic SSL
- A scalable setup
- Secure access

Now you can sync your notes across all your devices, knowing they never leave your server.

## Useful Resources

- [Standard Notes Self-hosting Documentation](https://standardnotes.com/help/self-hosting/docker)
- [Standard Notes Web App Docker Guide](https://standardnotes.com/help/self-hosting/web-app)
- [Caddy Documentation](https://caddyserver.com/docs/)
- [Docker Compose Documentation](https://docs.docker.com/compose/)
